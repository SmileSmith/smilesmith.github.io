<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Tree-Shakingè¿›é˜¶ä¹‹è·¯ | å‰è·¯æ¼«æ¼«</title>
    <meta name="description" content="å‰è·¯æ¼«æ¼« å½“å…‹å·± å½“æ…ç‹¬">
    
    
    <link rel="preload" href="/assets/css/0.styles.6dd12250.css" as="style"><link rel="preload" href="/assets/js/app.0623bd66.js" as="script"><link rel="preload" href="/assets/js/2.5dd5749f.js" as="script"><link rel="preload" href="/assets/js/7.c30685e8.js" as="script"><link rel="prefetch" href="/assets/js/10.fc6c68bf.js"><link rel="prefetch" href="/assets/js/11.ba650025.js"><link rel="prefetch" href="/assets/js/12.c6bd3826.js"><link rel="prefetch" href="/assets/js/13.65bc4a49.js"><link rel="prefetch" href="/assets/js/14.91612579.js"><link rel="prefetch" href="/assets/js/15.d9728f90.js"><link rel="prefetch" href="/assets/js/16.0cdff337.js"><link rel="prefetch" href="/assets/js/17.9b49432d.js"><link rel="prefetch" href="/assets/js/18.c6c32b37.js"><link rel="prefetch" href="/assets/js/19.d06222f2.js"><link rel="prefetch" href="/assets/js/20.8888a134.js"><link rel="prefetch" href="/assets/js/21.e7f0e2c3.js"><link rel="prefetch" href="/assets/js/22.1e32b4b7.js"><link rel="prefetch" href="/assets/js/23.2bdf04ee.js"><link rel="prefetch" href="/assets/js/24.2c3bbe4d.js"><link rel="prefetch" href="/assets/js/25.d1292960.js"><link rel="prefetch" href="/assets/js/26.6cabc15b.js"><link rel="prefetch" href="/assets/js/27.0d0f2ae0.js"><link rel="prefetch" href="/assets/js/28.d8f98424.js"><link rel="prefetch" href="/assets/js/3.1a1f1fe3.js"><link rel="prefetch" href="/assets/js/4.7d273734.js"><link rel="prefetch" href="/assets/js/5.e11c7487.js"><link rel="prefetch" href="/assets/js/6.3195bf77.js"><link rel="prefetch" href="/assets/js/8.8adcad81.js"><link rel="prefetch" href="/assets/js/9.f7bc9cde.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6dd12250.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/images/logo.png" alt="å‰è·¯æ¼«æ¼«" class="logo"> <span class="site-name can-hide">å‰è·¯æ¼«æ¼«</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">æ‰€æœ‰åšå®¢</a></div><div class="nav-item"><a href="http://gofrontend.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ä¸ªäººç½‘ç«™
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/SmileSmith/Blogs" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">æ‰€æœ‰åšå®¢</a></div><div class="nav-item"><a href="http://gofrontend.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ä¸ªäººç½‘ç«™
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/SmileSmith/Blogs" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Tree-Shakingè¿›é˜¶ä¹‹è·¯</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/201908/TreeShaking%E6%89%93%E6%80%AA%E5%8D%87%E7%BA%A7%E4%B9%8B%E8%B7%AF.html#ä¸€ã€ä»€ä¹ˆæ˜¯-tree-shakingï¼Ÿ" class="sidebar-link">ä¸€ã€ä»€ä¹ˆæ˜¯ Tree-Shakingï¼Ÿ</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/201908/TreeShaking%E6%89%93%E6%80%AA%E5%8D%87%E7%BA%A7%E4%B9%8B%E8%B7%AF.html#äºŒã€å¦‚ä½•ä½¿ç”¨-tree-shakingï¼Ÿ" class="sidebar-link">äºŒã€å¦‚ä½•ä½¿ç”¨ Tree-Shakingï¼Ÿ</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/201908/TreeShaking%E6%89%93%E6%80%AA%E5%8D%87%E7%BA%A7%E4%B9%8B%E8%B7%AF.html#ä¸‰ã€tree-shaking-å’Œ-commonjsmodule" class="sidebar-link">ä¸‰ã€Tree-Shaking å’Œ CommonJSModule</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/201908/TreeShaking%E6%89%93%E6%80%AA%E5%8D%87%E7%BA%A7%E4%B9%8B%E8%B7%AF.html#å››ã€tree-shaking-å’Œ-babelï¼Œé±¼å’Œç†ŠæŒå¯ä»¥å…¼å¾—" class="sidebar-link">å››ã€Tree-Shaking å’Œ Babelï¼Œé±¼å’Œç†ŠæŒå¯ä»¥å…¼å¾—</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/201908/TreeShaking%E6%89%93%E6%80%AA%E5%8D%87%E7%BA%A7%E4%B9%8B%E8%B7%AF.html#_4-1-babel-å¯¹-esmodule-æ¨¡å—çš„å¤„ç†" class="sidebar-link">4.1 Babel å¯¹ ESModule æ¨¡å—çš„å¤„ç†</a></li><li class="sidebar-sub-header"><a href="/201908/TreeShaking%E6%89%93%E6%80%AA%E5%8D%87%E7%BA%A7%E4%B9%8B%E8%B7%AF.html#_4-2-cjså’Œesæ··ç”¨å¯¼è‡´-babel-transform-runtime-å¼‚å¸¸" class="sidebar-link">4.2 cjså’Œesæ··ç”¨å¯¼è‡´ babel-transform-runtime å¼‚å¸¸</a></li></ul></li><li><a href="/201908/TreeShaking%E6%89%93%E6%80%AA%E5%8D%87%E7%BA%A7%E4%B9%8B%E8%B7%AF.html#äº”ã€tree-shaking-å’Œ-sideeffectï¼Œé”¦ä¸Šæ·»èŠ±" class="sidebar-link">äº”ã€Tree-Shaking å’Œ SideEffectï¼Œé”¦ä¸Šæ·»èŠ±</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/201908/TreeShaking%E6%89%93%E6%80%AA%E5%8D%87%E7%BA%A7%E4%B9%8B%E8%B7%AF.html#å…­ã€tree-shaking-å’Œ-sourcemapï¼Œæˆ‘å…¨éƒ½è¦" class="sidebar-link">å…­ã€Tree-Shaking å’Œ SourceMapï¼Œæˆ‘å…¨éƒ½è¦</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/201908/TreeShaking%E6%89%93%E6%80%AA%E5%8D%87%E7%BA%A7%E4%B9%8B%E8%B7%AF.html#ä¸ƒã€webé¡¹ç›®ä¸­ä½¿ç”¨tree-shakingçš„å®è·µå»ºè®®" class="sidebar-link">ä¸ƒã€webé¡¹ç›®ä¸­ä½¿ç”¨Tree-Shakingçš„å®è·µå»ºè®®</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/201908/TreeShaking%E6%89%93%E6%80%AA%E5%8D%87%E7%BA%A7%E4%B9%8B%E8%B7%AF.html#_1-énodeä½“ç³»çš„ä»£ç å°½é‡ä½¿ç”¨esmodule" class="sidebar-link">1. éNodeä½“ç³»çš„ä»£ç å°½é‡ä½¿ç”¨ESModule</a></li><li class="sidebar-sub-header"><a href="/201908/TreeShaking%E6%89%93%E6%80%AA%E5%8D%87%E7%BA%A7%E4%B9%8B%E8%B7%AF.html#_2-ç¼–å†™-esmodule-ä»£ç ï¼Œæœ‰å¤šä¸ªéå¼ºè€¦åˆçš„å¯¼å‡ºå†…å®¹æ—¶ï¼Œå°½é‡ä½¿ç”¨å‘½åå¯¼å‡º-æŒ‰éœ€å¯¼å…¥" class="sidebar-link">2. ç¼–å†™ ESModule ä»£ç ï¼Œæœ‰å¤šä¸ªéå¼ºè€¦åˆçš„å¯¼å‡ºå†…å®¹æ—¶ï¼Œå°½é‡ä½¿ç”¨å‘½åå¯¼å‡º/æŒ‰éœ€å¯¼å…¥</a></li><li class="sidebar-sub-header"><a href="/201908/TreeShaking%E6%89%93%E6%80%AA%E5%8D%87%E7%BA%A7%E4%B9%8B%E8%B7%AF.html#_3-babel-é…ç½®ä¸­å¯¹-commonjs-æ¨¡å—ç‰¹æ®Šé…ç½®ï¼Œæ³¨æ„babel-6å’Œbable-7çš„åŒºåˆ«" class="sidebar-link">3. Babel é…ç½®ä¸­å¯¹ CommonJS æ¨¡å—ç‰¹æ®Šé…ç½®ï¼Œæ³¨æ„babel@6å’Œbable@7çš„åŒºåˆ«</a></li><li class="sidebar-sub-header"><a href="/201908/TreeShaking%E6%89%93%E6%80%AA%E5%8D%87%E7%BA%A7%E4%B9%8B%E8%B7%AF.html#_4-webpack-4ä½“ç³»ä¸­ï¼Œå¦‚æœæ˜¯å…¬å¸å†…éƒ¨çš„npmæ¨¡å—ï¼Œæ˜ç¡®æ— å‰¯ä½œç”¨çš„ï¼Œæ ‡è®°-sideeffects" class="sidebar-link">4. webpack@4ä½“ç³»ä¸­ï¼Œå¦‚æœæ˜¯å…¬å¸å†…éƒ¨çš„npmæ¨¡å—ï¼Œæ˜ç¡®æ— å‰¯ä½œç”¨çš„ï¼Œæ ‡è®° sideEffects</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="tree-shakingè¿›é˜¶ä¹‹è·¯"><a href="#tree-shakingè¿›é˜¶ä¹‹è·¯" class="header-anchor">#</a> Tree-Shakingè¿›é˜¶ä¹‹è·¯</h1> <h2 id="ä¸€ã€ä»€ä¹ˆæ˜¯-tree-shakingï¼Ÿ"><a href="#ä¸€ã€ä»€ä¹ˆæ˜¯-tree-shakingï¼Ÿ" class="header-anchor">#</a> ä¸€ã€ä»€ä¹ˆæ˜¯ Tree-Shakingï¼Ÿ</h2> <p>åœ¨<a href="https://webpack.js.org/guides/tree-shaking/" target="_blank" rel="noopener noreferrer">webpackå®˜æ–¹æ–‡æ¡£<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>çš„å®šä¹‰æ˜¯: Tree-Shaking ç”¨äºç§»é™¤ JavaScript ä¸Šä¸‹æ–‡ä¸­çš„æœªå¼•ç”¨ä»£ç ã€Œdead-codeã€ã€‚åœ¨ webpack ä¸­ï¼ŒåŸºäº ES2015 æ¨¡å—ï¼ˆä¹Ÿå«åš <strong>harmony</strong> æ¨¡å—ï¼‰çš„é™æ€åˆ†æèƒ½åŠ›ï¼Œç¡®å®šæ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œè¿›è€Œæ‰¾å‡ºä¸éœ€è¦çš„ä¾èµ–ï¼Œåœ¨æ„å»ºé˜¶æ®µå°±åˆ é™¤ä¸éœ€è¦çš„ä¾èµ–ã€‚</p> <p>åœ¨å®é™…ä¸šåŠ¡å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€ä¼šå¼•å…¥è®¸å¤šnpmåŒ…ï¼Œä¸ºäº†åŠ å¿«ç”¨æˆ·ä¸‹è½½è„šæœ¬çš„å¤§å°å’Œæ—¶é—´ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬éƒ½ä¼šåˆ©ç”¨ Tree-Shaking çš„ç‰¹æ€§æ¥å‡å°æ‰“åŒ…åä»£ç çš„ä½“ç§¯ã€‚</p> <p><img src="/assets/img/7.f55bbd5e.png" alt="01.No-Tree-Shaking"></p> <p><img src="/assets/img/6.7fd99528.png" alt="02.With-Tree-Shaking"></p> <h2 id="äºŒã€å¦‚ä½•ä½¿ç”¨-tree-shakingï¼Ÿ"><a href="#äºŒã€å¦‚ä½•ä½¿ç”¨-tree-shakingï¼Ÿ" class="header-anchor">#</a> äºŒã€å¦‚ä½•ä½¿ç”¨ Tree-Shakingï¼Ÿ</h2> <ol><li>ä»£ç ä¸­ä½¿ç”¨ ESModuleï¼Œåœ¨å¯¼å…¥æ—¶ä½¿ç”¨æŒ‰éœ€å¯¼å…¥çš„è¯­æ³• <code>import { foo, bar } from './ESModule';</code></li> <li>webpackä¸­æ²¡æœ‰ç¼–è¯‘å™¨æŠŠ ESModule è½¬æ¢æˆ CommonJSModule</li> <li>webpacké»˜è®¤ä¼šè¿›è¡Œ Tree-Shakingï¼Œæ ‡è®°æœªè¢«ä½¿ç”¨çš„å¯¼å‡ºå†…å®¹ä¸º <strong>unused harmony export</strong></li> <li>é…ç½®uglifyJSç­‰webpackä»£ç å‹ç¼©æ’ä»¶ä¼šåˆ æ‰ è¢«webpackæ ‡è®°ä¸º <strong>unused harmony export</strong>çš„ä»£ç </li></ol> <p><em>// webpack@4.xä¸­å·²ç»å¼ƒç”¨å•ç‹¬é…ç½®uglifyJSPluginçš„æ–¹å¼ï¼Œç¬¬4ç‚¹ä¿®æ”¹ä¸ºé…ç½®mode=production</em></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// in index.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> foo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./es'</span><span class="token punctuation">;</span>

<span class="token comment">// in webpack.config.js in webpack@2@3</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">UglifyJsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>sourceMap<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span> compress<span class="token operator">:</span> <span class="token punctuation">{</span>warnings<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token comment">// in webpack.config.js in webpack@4</span>
    mode<span class="token operator">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span>
</code></pre></div><h2 id="ä¸‰ã€tree-shaking-å’Œ-commonjsmodule"><a href="#ä¸‰ã€tree-shaking-å’Œ-commonjsmodule" class="header-anchor">#</a> ä¸‰ã€Tree-Shaking å’Œ CommonJSModule</h2> <p>åœ¨ä¸Šé¢å·²ç»æåˆ°: Tree-Shaking æ˜¯åŸºäºé™æ€æ¨¡å—åˆ†æçš„ï¼Œå› æ­¤å¯¹äº CommonJS è§„èŒƒçš„JSæ¨¡å—ï¼ŒTree-Shaking ä¸ä¼šç”Ÿæ•ˆï¼Œwebpack åœ¨æ‰“åŒ…æ—¶ä¼šå…¨é‡æ‰“åŒ…è‡³ chunk é‡Œã€‚</p> <h2 id="å››ã€tree-shaking-å’Œ-babelï¼Œé±¼å’Œç†ŠæŒå¯ä»¥å…¼å¾—"><a href="#å››ã€tree-shaking-å’Œ-babelï¼Œé±¼å’Œç†ŠæŒå¯ä»¥å…¼å¾—" class="header-anchor">#</a> å››ã€Tree-Shaking å’Œ Babelï¼Œé±¼å’Œç†ŠæŒå¯ä»¥å…¼å¾—</h2> <p>è¿™é‡Œ Babel å’Œ Tree-Shaking åˆæœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿ</p> <p>åœ¨å®é™…çš„webä¸šåŠ¡ä¸­ï¼Œæˆ‘ä»¬å¾ˆéš¾è¦æ±‚ç”¨æˆ·ä½¿ç”¨å®Œæ•´æ”¯æŒES6çš„æµè§ˆå™¨ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šåˆ©ç”¨ babel-loader å°†ES6æºç è½¬æ¢æˆæµè§ˆå™¨å¯è§£æçš„JSã€‚</p> <p>é—®é¢˜çš„ç­”æ¡ˆæ˜¯ babel-preset-env ä¸­æœ‰ä¸€é¡¹é»˜è®¤é…ç½®ï¼š <code>module: 'cjs'</code>ã€‚è¿™é¡¹é…ç½®çš„ä½œç”¨æ˜¯ï¼š<code>babelå¯¹ESModuleçš„è½¬æ¢æ–¹å¼</code>ï¼Œé»˜è®¤çš„cjsä¼šæŠŠæºç ä¸­æ‰€æœ‰çš„ESModuleè½¬æ¢æˆCommonJSModuleï¼ï¼ï¼</p> <h3 id="_4-1-babel-å¯¹-esmodule-æ¨¡å—çš„å¤„ç†"><a href="#_4-1-babel-å¯¹-esmodule-æ¨¡å—çš„å¤„ç†" class="header-anchor">#</a> 4.1 Babel å¯¹ ESModule æ¨¡å—çš„å¤„ç†</h3> <p>é¦–å…ˆï¼Œæ˜¯åŠ¨æ€æ¨¡å—å’Œé™æ€æ¨¡å—çš„é—®é¢˜ï¼Œé™æ€æ¨¡å—å¯ä»¥è½¬æ¢æˆåŠ¨æ€æ¨¡å—ï¼Œåä¹‹åˆ™ä¸èƒ½ã€‚</p> <ul><li>static(es) --&gt; dynamic(cjs) âœ…</li> <li>dynamic(cjs) -/-&gt; static(es) âŒ</li></ul> <p>babelåœ¨è®¾è®¡æ—¶å¯èƒ½è€ƒè™‘åˆ°äº†è¿™ä¸ªå› ç´ : æ—¢ç„¶ä»£ç ä¸­å¯èƒ½æ··æ‚cjså’Œesï¼Œå¹¶ä¸”cjsä¸èƒ½è½¬æ¢æˆesï¼Œé‚£å°±é»˜è®¤æŠŠæ‰€æœ‰esè½¬æ¢æˆcjsï¼Œå‡†æ²¡é”™ã€‚</p> <p>æ­¤å¤–ï¼Œbabel-preset-envæä¾›äº†<code>module</code>çš„é…ç½®ï¼Œæˆ‘ä»¬å¯ä»¥é…ç½®<code>module: false</code>ï¼Œè®©babelä¸è½¬æ¢ ESModuleï¼Œè¿™æ ·webpackä¸­Tree-Shakingå°±å¯ä»¥æ­£å¸¸å·¥ä½œ</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    loader<span class="token operator">:</span> <span class="token string">&quot;babel-loader&quot;</span><span class="token punctuation">,</span>
    options<span class="token operator">:</span> <span class="token punctuation">{</span>
        presets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;env&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span> modules<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;stage-2&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="_4-2-cjså’Œesæ··ç”¨å¯¼è‡´-babel-transform-runtime-å¼‚å¸¸"><a href="#_4-2-cjså’Œesæ··ç”¨å¯¼è‡´-babel-transform-runtime-å¼‚å¸¸" class="header-anchor">#</a> 4.2 cjså’Œesæ··ç”¨å¯¼è‡´ babel-transform-runtime å¼‚å¸¸</h3> <p>æˆ‘ä»¬çŸ¥é“ï¼ŒBabel åœ¨è½¬æ¢ES5ä»¥ä¸Šçš„è¯­æ³•æ—¶ä¼šéœ€è¦ä¸€äº›polyfillï¼Œæ¯”å¦‚es-classã€‚</p> <ul><li>å¦‚æœä¸åšç‰¹åˆ«å¤„ç†ï¼ŒBabel ä¼šæŠŠæ¯ä¸ªclasséƒ½è½¬æ¢æˆå®Œæ•´çš„ES5-classå®ç°ï¼Œäº§ç”Ÿå¾ˆå¤šå†—ä½™ä»£ç </li> <li>å¦‚æœç”¨å…¨å±€polyfillï¼Œä¼šæ±¡æŸ“å…¨å±€ä¸Šä¸‹æ–‡ï¼Œå¹¶ä¸”éœ€è¦æ‰‹åŠ¨éœ€è¦å“ªäº›polyfillï¼Œæ¯”è¾ƒç¹ç</li></ul> <p>babel-transform-runtime å¯ä»¥è§£å†³ä¸Šé¢æåˆ°é—®é¢˜ï¼šå®ƒä¼šåœ¨ç”¨åˆ° es-class çš„æ¨¡å—ä¸­ <code>import</code> ä¸€ä¸ªå…¬å…±çš„ class-helper å®ç°ã€‚è¿™æ ·å°±ä»¥æœ€å°çš„ä½“ç§¯ä»£ä»·ï¼Œåªå½±å“éœ€è¦ polyfill çš„JSæ¨¡å—ã€‚è¯¦æƒ…å¯é˜…è¯»ï¼š<a href="https://babeljs.io/docs/en/babel-plugin-transform-runtime#why" target="_blank" rel="noopener noreferrer">why babel-transfrom-runtime<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    loader<span class="token operator">:</span> <span class="token string">&quot;babel-loader&quot;</span><span class="token punctuation">,</span>
    options<span class="token operator">:</span> <span class="token punctuation">{</span>
        presets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;env&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span> modules<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;stage-2&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
        plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;transform-runtime&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p><img src="/assets/img/3.947f9dac.jpg" alt="polyfill"></p> <p>å…³äº Tree-Shaking çš„é—®é¢˜åœ¨å“ªé‡Œï¼Ÿ</p> <p>å½“ä½ çš„é¡¹ç›®ä¸­æœ‰æ··ç”¨ ESModule å’Œ CommonJSModule çš„æ—¶å€™ï¼Œæœ‰å¯èƒ½è§¦å‘ä¸€ä¸ªé…ç½®å†²çªé—®é¢˜ã€‚åœ¨è¯´æ˜è¿™ä¸ªé—®é¢˜ä¹‹é—´æˆ‘ä»¬å‰ç½®ä¸¤ä¸ªæŠ€æœ¯ç‚¹ï¼š</p> <ol><li>ä¸Šé¢æåˆ°ï¼Œbabel-transfrom-runtime ä¼šå¾€éœ€è¦ polyfill çš„æ¨¡å—ä¸­ <strong>å¯¼å…¥</strong> polyfillä»£ç ã€‚</li> <li>ç°ä»£JSç¼–è¯‘å™¨ï¼Œå¯¹äºJSæ¨¡å—çš„è§£æï¼Œå¦‚æœä»£ç ä¸­å‡ºç° import æˆ–è€… exportï¼Œå®ƒå°±è¢«å½“ä½œ ESModuleã€‚åœ¨ ESModule ä¸­ module æ˜¯ä¿ç•™å­—ï¼Œä¸å…è®¸ä»»ä½•æ“ä½œï¼Œæ¯”å¦‚<code>module.exports = xxx</code>ä¼šæŠ¥å¦‚ä¸‹é”™è¯¯ï¼š</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code>// <span class="token keyword">in</span> terminal wepack error: jsæ¨¡å—é”™è¯¯å¯¼è‡´æ¨¡å—è§£æé”™è¯¯
WARNING <span class="token keyword">in</span> ./index.js
<span class="token builtin class-name">export</span> <span class="token string">'promise'</span> <span class="token punctuation">(</span>imported as <span class="token string">'CommonJSModule'</span><span class="token punctuation">)</span> was not found <span class="token keyword">in</span> <span class="token string">'./cjs.js'</span>

// <span class="token keyword">in</span> browser <span class="token function">open</span> js error: å…·ä½“jsé”™è¯¯
Cannot assign to <span class="token builtin class-name">read</span> only property <span class="token string">'exports'</span> of object <span class="token string">'#&lt;Object&gt;'</span>
</code></pre></div><p>å½“æ»¡è¶³ä»¥ä¸‹æ¡ä»¶æ—¶ï¼Œtransform-runtime<strong>å¾€CommonJSæ¨¡å—ä¸­importå¯¼å…¥polyfill</strong>ï¼Œå°±ä¼šå‡ºç°ä¸Šé¢çš„é”™è¯¯ï¼š</p> <ol><li>ä½¿ç”¨4.2ä¸­æ‰€ç¤ºçš„Babelé…ç½®: <code>modules:false &amp;&amp; babel-plugin-transform-runtime</code></li> <li>åœ¨ESModuleä¸­å¯¼å…¥CommonJSModuleçš„è¡Œä¸º</li> <li>CommonJSModuleä¸­æœ‰éœ€è¦polyfillçš„ä»£ç ï¼ˆå¦‚ä½¿ç”¨ES6 classè¯­æ³•ï¼‰</li></ol> <p>åˆ†æç»“æœæ˜¯cjså’Œesæ··ç”¨çš„é¡¹ç›®ä¸­ï¼Œç›´æ¥é…ç½®<code>modules:false</code>å’Œ<code>babel-plugin-transform-runtime</code>æ˜¯æœ‰å†²çªçš„</p> <ul><li><p>å¦‚æœä»…æœ‰<code>module:false</code>ï¼Œtransform-runtimeå¾€CommonJSModuleä¸­å¯¼å…¥polyfillä¼šä½¿ç”¨reqireçš„æ–¹å¼ï¼Œä¸ä¼šæŠ¥é”™ã€‚ä½†æ˜¯ä¼šå¯¼è‡´å…¶å®ƒESModuleåœ¨webpackä¸­çš„ Tree-Shaking å¤±æ•ˆğŸ˜¢</p></li> <li><p>å¦‚æœä»…æœ‰transform-runtimeï¼Œå°±ä¸ä¼šæœ‰æœ‰polyfillå¯¼å…¥ï¼ŒCommonJSModule åŸæ ·è¾“å‡ºï¼Œè¢«webpackå½“ä½œ CommonJS æ¨¡å—ï¼Œä¸ä¼šæŠ¥é”™ã€‚ä½†æ˜¯æ²¡æœ‰ transform-runtimeï¼Œæƒ³ä½¿ç”¨æ–°çš„è¯­æ³•å°±å¾—ç”¨å…¨å±€å¯¼å…¥ babel-polyfill çš„æ–¹å¼ğŸ˜¢</p></li></ul> <p><img src="/assets/img/4.6844779b.jpg" alt="harmony-import"></p> <p>è§£å†³ä¹‹æ³•æ˜¯é’ˆå¯¹ESModuleå’ŒCommonJSæ¨¡å—åˆ†åˆ«é…ç½®babelå¤„ç†çš„æ–¹å¼ï¼Œè¯¦æƒ…è§<a href="https://github.com/babel/babel/issues/9238" target="_blank" rel="noopener noreferrer">babel/issues/9238<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>rules<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    test<span class="token operator">:</span> <span class="token regex">/cjs\.js$/</span><span class="token punctuation">,</span>
    use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
        loader<span class="token operator">:</span> <span class="token string">&quot;babel-loader&quot;</span><span class="token punctuation">,</span>
        options<span class="token operator">:</span> <span class="token punctuation">{</span>
            presets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;env&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> modules<span class="token operator">:</span> <span class="token string">&quot;commonjs&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;stage-2&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;transform-runtime&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            cacheDirectory<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token comment">// CommonJSè§„èŒƒçš„ä½¿ç”¨sourceType: &quot;script&quot;</span>
            sourceType<span class="token operator">:</span> <span class="token string">&quot;script&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span>
    test<span class="token operator">:</span> <span class="token regex">/(es|index)\.js$/</span><span class="token punctuation">,</span>
    use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
        loader<span class="token operator">:</span> <span class="token string">&quot;babel-loader&quot;</span><span class="token punctuation">,</span>
        options<span class="token operator">:</span> <span class="token punctuation">{</span>
            presets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;env&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span> modules<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;stage-2&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;transform-runtime&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token comment">// ESè§„èŒƒçš„ä½¿ç”¨sourceType: &quot;module&quot;ï¼ˆé»˜è®¤å€¼ï¼‰</span>
            sourceType<span class="token operator">:</span> <span class="token string">&quot;module&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">]</span>

</code></pre></div><p><em>// babel@7.xä¸­å¯ä»¥åˆå¹¶é…ç½®</em></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>rules<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex">/\.js$/</span><span class="token punctuation">,</span>
        exclude<span class="token operator">:</span> <span class="token regex">/node_modules/</span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
                loader<span class="token operator">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
                options<span class="token operator">:</span> <span class="token punctuation">{</span>
                    presets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'@babel/preset-env'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> modules<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@babel/plugin-transform-runtime'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    <span class="token comment">// babel@7æ–°å¢unambiguous</span>
                    <span class="token comment">// transform-runtimeå¯ä»¥è‡ªåŠ¨è¯†åˆ«æ¨¡å—ç±»å‹ï¼Œæ ¹æ®æ¨¡å—ç±»å‹ä½¿ç”¨ä¸åŒçš„â€œå¯¼å…¥â€</span>
                    sourceType<span class="token operator">:</span> <span class="token string">&quot;unambiguous&quot;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>

</code></pre></div><h2 id="äº”ã€tree-shaking-å’Œ-sideeffectï¼Œé”¦ä¸Šæ·»èŠ±"><a href="#äº”ã€tree-shaking-å’Œ-sideeffectï¼Œé”¦ä¸Šæ·»èŠ±" class="header-anchor">#</a> äº”ã€Tree-Shaking å’Œ SideEffectï¼Œé”¦ä¸Šæ·»èŠ±</h2> <p>SideEffect æ˜¯ webpack@v4 çš„é‡è¦ç‰¹æ€§ä¹‹ä¸€ï¼Œæ˜¯ Tree-Shaking çš„é‡è¦è¡¥å……ï¼Œå¯ä»¥è®© webpack æ›´å¥½åœ°è¿›è¡Œæ— ç”¨ä»£ç çš„å‰¥ç¦»ã€‚</p> <p>å³ä½¿ä¾èµ–çš„npmåŒ…çš„ package.json ä¸­æ²¡æœ‰æ ‡è®° sideEffectsï¼ŒTree-Shaking è¿‡ç¨‹ä¸­ä¹Ÿä¼šåˆ©ç”¨<a href="https://github.com/terser-js/terser" target="_blank" rel="noopener noreferrer">terser<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>æ¥åˆ†ææ¨¡ä¸­çš„å‰¯ä½œç”¨æ¥åˆ¤æ–­å“ªäº›ä»£ç å¯ä»¥ä¼˜åŒ–æ‰ã€‚ç„¶è€Œå› ä¸ºJSè¯­è¨€å¤©ç”Ÿçš„åŠ¨æ€æ€§ï¼Œterserå¯¹å‰¯ä½œç”¨çš„åˆ¤æ–­å¾ˆéš¾åšåˆ°éå¸¸å‡†ç¡®ï¼Œå¤šæ•°æƒ…å†µä¸‹å®ƒçš„å·¥ä½œè¿˜æ˜¯è¡¨ä¿å®ˆã€‚å› æ­¤éœ€è¦ç¼–å†™npmåŒ…çš„ä½œè€…è‡ªå·±æ¥å®šä¹‰è‡ªå·±åŒ…ä¸­çš„å‰¯ä½œç”¨ã€‚</p> <p><em>&quot;å‰¯ä½œç”¨&quot;å®šä¹‰æ˜¯ï¼šå¯¼å…¥æ—¶å°±æ‰§è¡Œçš„ç‰¹å®šè¡Œä¸ºçš„ä»£ç ï¼Œè€Œä¸æ˜¯é»˜è®¤å¯¼å‡ºæˆ–å¤šä¸ªå‘½åå¯¼å‡ºã€‚ä¸€ä¸ªå…¸å‹ä¾‹å­æ˜¯polyfillsï¼Œå®ƒä¼šå½±å“å…¨å±€ï¼Œä½†é€šå¸¸ä¸åœ¨æ¨¡å—ä¸­å¯¼å‡ºã€‚</em></p> <p>æ¯”å¦‚æˆ‘ä»¬ç¼–å†™äº†1ä¸ªButtonç»„ä»¶ï¼Œå¹¶å‡†å¤‡å‘å¸ƒnpmåŒ…ã€‚å¦‚æœç¡®è®¤è¯¥åŒ…ä¸‹æ²¡æœ‰ä»»ä½•å‰¯ä½œç”¨çš„ä»£ç ï¼Œå°±å¯ä»¥åœ¨ packeage.json æ ‡è®° sideEffects ä¸ºfalseã€‚webpackåœ¨å¤„ç†è¯¥æ¨¡å—æ—¶ï¼Œä¼šå¿½ç•¥æ‰€æœ‰éå¯¼å‡ºçš„å†…å®¹ã€‚</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;@my-ui/Button&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;sideEffects&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å†æ¯”å¦‚æˆ‘ä»¬ç¼–å†™äº†1ä¸ªLayoutç»„ä»¶ï¼Œå¹¶å‡†å¤‡å‘å¸ƒnpmåŒ…ã€‚å¦‚æœç¡®è®¤è¯¥åŒ…ä¸‹æŸä¸ªæœªè¢«å¼•ç”¨çš„ reset.css æœ‰å…¨å±€ä½œç”¨ï¼ˆå‰¯ä½œç”¨ï¼‰ï¼Œå°±å¯ä»¥åœ¨ packeage.json è®¾ç½® sideEffects å€¼ä¸ºè¯¥cssæ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„ã€‚webpack åœ¨å¤„ç†è¯¥æ¨¡å—æ—¶ï¼Œä¼šå¿½ç•¥éå¯¼å‡ºçš„å†…å®¹ï¼Œè€Œè¯¥ reset.css è¿˜ä¼šè¢«æ‰“åŒ…è¿›æ¥ã€‚</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;@my-ui/Button&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;sideEffects&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;./reset.css&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æ›´å¤šå¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://webpack.js.org/guides/tree-shaking/#clarifying-tree-shaking-and-sideeffects" target="_blank" rel="noopener noreferrer">clarifying-tree-shaking-and-sideeffects<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="å…­ã€tree-shaking-å’Œ-sourcemapï¼Œæˆ‘å…¨éƒ½è¦"><a href="#å…­ã€tree-shaking-å’Œ-sourcemapï¼Œæˆ‘å…¨éƒ½è¦" class="header-anchor">#</a> å…­ã€Tree-Shaking å’Œ SourceMapï¼Œæˆ‘å…¨éƒ½è¦</h2> <p>æœ‰åŒå­¦è¦é—®äº†ï¼šå¦‚æœ Tree-Shaking æŠŠæ— ç”¨ä»£ç åˆ é™¤åï¼Œè¿˜èƒ½åœ¨SourceMap å¸®åŠ©ä¸‹çœ‹åˆ°ç›¸å…³çš„æºç å—ï¼Ÿ</p> <p>ç­”æ¡ˆæ˜¯å¯ä»¥çš„ï¼š</p> <p><img src="/assets/img/5.9998e317.jpg" alt="source-map"></p> <h2 id="ä¸ƒã€webé¡¹ç›®ä¸­ä½¿ç”¨tree-shakingçš„å®è·µå»ºè®®"><a href="#ä¸ƒã€webé¡¹ç›®ä¸­ä½¿ç”¨tree-shakingçš„å®è·µå»ºè®®" class="header-anchor">#</a> ä¸ƒã€webé¡¹ç›®ä¸­ä½¿ç”¨Tree-Shakingçš„å®è·µå»ºè®®</h2> <h3 id="_1-énodeä½“ç³»çš„ä»£ç å°½é‡ä½¿ç”¨esmodule"><a href="#_1-énodeä½“ç³»çš„ä»£ç å°½é‡ä½¿ç”¨esmodule" class="header-anchor">#</a> 1. éNodeä½“ç³»çš„ä»£ç å°½é‡ä½¿ç”¨ESModule</h3> <p>CommonJSModule çš„åŠ¨æ€æ€§å’Œ ESModule çš„é™æ€ç‰¹æ˜¯å®é™…åº”ç”¨ä¸­å¹³è¡¡å–èˆçš„å½¢æˆçš„ï¼Œæ²¡ç»å¯¹çš„å¥½åã€‚å½“ç„¶ï¼Œå¦‚æœä½ çš„æ¨¡å—åªåœ¨webç«¯ä½¿ç”¨ï¼ˆæ— nodeçš„åº”ç”¨åœºæ™¯ï¼‰ï¼Œä¸”æ²¡æœ‰ç”¨åˆ°åŠ¨æ€å¯¼å…¥ã€æ¡ä»¶å¯¼å…¥çš„ç‰¹æ€§ï¼Œå»ºè®®ä½¿ç”¨ ESModule è§„èŒƒæ¥æ¨¡å—åŒ–ä½ çš„ä»£ç ã€‚</p> <h3 id="_2-ç¼–å†™-esmodule-ä»£ç ï¼Œæœ‰å¤šä¸ªéå¼ºè€¦åˆçš„å¯¼å‡ºå†…å®¹æ—¶ï¼Œå°½é‡ä½¿ç”¨å‘½åå¯¼å‡º-æŒ‰éœ€å¯¼å…¥"><a href="#_2-ç¼–å†™-esmodule-ä»£ç ï¼Œæœ‰å¤šä¸ªéå¼ºè€¦åˆçš„å¯¼å‡ºå†…å®¹æ—¶ï¼Œå°½é‡ä½¿ç”¨å‘½åå¯¼å‡º-æŒ‰éœ€å¯¼å…¥" class="header-anchor">#</a> 2. ç¼–å†™ ESModule ä»£ç ï¼Œæœ‰å¤šä¸ªéå¼ºè€¦åˆçš„å¯¼å‡ºå†…å®¹æ—¶ï¼Œå°½é‡ä½¿ç”¨å‘½åå¯¼å‡º/æŒ‰éœ€å¯¼å…¥</h3> <h3 id="_3-babel-é…ç½®ä¸­å¯¹-commonjs-æ¨¡å—ç‰¹æ®Šé…ç½®ï¼Œæ³¨æ„babel-6å’Œbable-7çš„åŒºåˆ«"><a href="#_3-babel-é…ç½®ä¸­å¯¹-commonjs-æ¨¡å—ç‰¹æ®Šé…ç½®ï¼Œæ³¨æ„babel-6å’Œbable-7çš„åŒºåˆ«" class="header-anchor">#</a> 3. Babel é…ç½®ä¸­å¯¹ CommonJS æ¨¡å—ç‰¹æ®Šé…ç½®ï¼Œæ³¨æ„babel@6å’Œbable@7çš„åŒºåˆ«</h3> <h3 id="_4-webpack-4ä½“ç³»ä¸­ï¼Œå¦‚æœæ˜¯å…¬å¸å†…éƒ¨çš„npmæ¨¡å—ï¼Œæ˜ç¡®æ— å‰¯ä½œç”¨çš„ï¼Œæ ‡è®°-sideeffects"><a href="#_4-webpack-4ä½“ç³»ä¸­ï¼Œå¦‚æœæ˜¯å…¬å¸å†…éƒ¨çš„npmæ¨¡å—ï¼Œæ˜ç¡®æ— å‰¯ä½œç”¨çš„ï¼Œæ ‡è®°-sideeffects" class="header-anchor">#</a> 4. webpack@4ä½“ç³»ä¸­ï¼Œå¦‚æœæ˜¯å…¬å¸å†…éƒ¨çš„npmæ¨¡å—ï¼Œæ˜ç¡®æ— å‰¯ä½œç”¨çš„ï¼Œæ ‡è®° sideEffects</h3></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/SmileSmith/Blogs/edit/master/docs/201908/TreeShakingæ‰“æ€ªå‡çº§ä¹‹è·¯.md" target="_blank" rel="noopener noreferrer">å¸®åŠ©æ”¹å–„æ­¤é¡µé¢ï¼</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">æœ€åæ›´æ–°:</span> <span class="time">12/29/2019, 11:32:53 AM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.0623bd66.js" defer></script><script src="/assets/js/2.5dd5749f.js" defer></script><script src="/assets/js/7.c30685e8.js" defer></script>
  </body>
</html>
